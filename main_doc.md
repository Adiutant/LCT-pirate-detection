# Документация
[Назад в README](README.md)
# Описание
Этот файл выполняет обнаружение пиратских видеофайлов путем сравнения эмбеддингов видео и аудио с лицензионными видео. Основные функции включают расчет F1-меры для поиска, проверку сходства между двумя видео и помощь в работе с базой данных эмбеддингов.
## calculate_f1_score
Эта функция рассчитывает F1-меру, которая является гармоническим средним между точностью и полнотой. Она принимает три параметра: число истинно положительных, ложно положительных и ложно отрицательных результатов, и возвращает значение F1-меры.
## find_license_by_pirate_name
Эта функция ищет в DataFrame строку с заданным названием пиратского файла и возвращает соответствующий ID лицензионного видео. Если совпадений нет, функция возвращает None.
## f1_for_all_search
Эта функция рассчитывает F1-меру для всех видеопоисков. Она извлекает видео и аудио эмбеддинги из пиратских видеофайлов, выполняет поиск по базе данных эмбеддингов и сравнивает результаты с истиной (ground truth). Возвращает значение F1-меры.
## check_similarity
Эта функция проверяет сходство между двумя видеофайлами. Она извлекает эмбеддинги видео и аудио из двух видеофайлов, добавляет их в векторную базу данных и выполняет поиск по базе данных. В итоге строится матрица косинусного сходства для видео и аудио, и выводятся результаты.

## main
В основном блоке происходит инициализация модели ViT и ViTFeatureExtractor, установка устройства (CPU или GPU), инициализация базы данных эмбеддингов и выполнение функции для расчета F1-меры для всех видеопоисков.

