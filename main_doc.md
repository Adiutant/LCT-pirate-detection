# Документация
[Назад в README](README.md)
# Описание
Этот файл использовался для тестирования работы моделей и для генерации csv файла для отправки, чтобы не тратить лишнее время на взаимодействие сервисов. Присутствуют функции для обнаружения пиратских видеофайлов путем сравнения эмбеддингов видео и аудио с лицензионными видео. Основные функции включают расчет F1-меры для поиска, проверку сходства между двумя видео и помощь в работе с базой данных эмбеддингов.
## calculate_f1_score
Эта функция рассчитывает F1-меру, которая является гармоническим средним между точностью и полнотой. Она принимает три параметра: число истинно положительных, ложно положительных и ложно отрицательных результатов, и возвращает значение F1-меры.
## find_license_by_pirate_name
Эта функция ищет в DataFrame строку с заданным названием пиратского файла и возвращает соответствующий ID лицензионного видео. Если совпадений нет, функция возвращает None.
## f1_for_all_search
Эта функция рассчитывает F1-меру для всех видеофайлов. Она извлекает видео и аудио эмбеддинги из пиратских видеофайлов, выполняет поиск по базе данных эмбеддингов и сравнивает результаты с истиной (ground truth). Возвращает значение F1-меры.
## check_similarity
Эта функция проверяет сходство между двумя видеофайлами. Она извлекает эмбеддинги видео и аудио из двух видеофайлов, добавляет их в векторную базу данных и выполняет поиск по базе данных. В итоге строится матрица косинусного сходства для видео и аудио, и выводятся результаты.
## create_test_csv
Эта функция находит совпадение с видео и вычисляет видео фрагменты сходства. Результат записывается в csv файл.

## main
В основном блоке происходит инициализация моделей, например, для тестирования использовались ViT и ViTFeatureExtractor для проверки одного решения, и Сиамская модель для проверки другого решения, осуществлялась установка устройства (CPU или GPU), инициализация базы данных эмбеддингов и выполнение функции для расчета F1-меры для всех видеопоисков. Кроме того, через main осуществлялось сохранение результатов работы модели в тестовый csv файл.

